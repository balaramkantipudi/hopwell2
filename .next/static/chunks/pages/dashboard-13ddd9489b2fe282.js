(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[26],{1075:function(e,s,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard",function(){return r(1945)}])},1945:function(e,s,r){"use strict";r.r(s),r.d(s,{default:function(){return Dashboard}});var i=r(5893),l=r(8998),t=r(1163),n=r(1664),a=r.n(n),d=r(7294),c=r(5201);function UserCreditDisplay(){let{user:e}=(0,l.a)(),[s,r]=(0,d.useState)(null),[t,n]=(0,d.useState)(!0),[o,m]=(0,d.useState)(null);return((0,d.useEffect)(()=>{if(!e)return;let fetchCredits=async()=>{try{n(!0),m(null);let{data:s,error:i}=await c.O.from("user_credits").select("*").eq("user_id",e.id).single();if(i){if("PGRST116"===i.code){let e=await fetch("/api/credits/initialize",{method:"POST",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("Failed to initialize credits");let s=await e.json();r(s)}else throw Error("Failed to fetch credits: ".concat(i.message))}else r(s)}catch(e){console.error("Error processing credits:",e),m(e.message)}finally{n(!1)}};fetchCredits()},[e]),t)?(0,i.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow-sm animate-pulse",children:[(0,i.jsx)("div",{className:"h-6 bg-gray-200 rounded w-2/3 mb-2"}),(0,i.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/2"})]}):o?(0,i.jsxs)("div",{className:"bg-red-50 border-l-4 border-red-400 p-4 rounded-lg",children:[(0,i.jsxs)("p",{className:"text-red-700",children:["Error loading credits: ",o]}),(0,i.jsx)("button",{onClick:()=>window.location.reload(),className:"mt-2 text-sm text-red-700 underline",children:"Try Again"})]}):s?(0,i.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow-sm",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center",children:[(0,i.jsx)("h3",{className:"font-semibold text-lg",children:"Your Trip Credits"}),s.credits_remaining<2&&(0,i.jsx)(a(),{href:"/pricing",className:"text-sm text-white bg-indigo-600 hover:bg-indigo-700 px-2 py-1 rounded",children:"Get More"})]}),(0,i.jsxs)("div",{className:"mt-2",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,i.jsx)("span",{className:"text-gray-600",children:"Credits remaining"}),(0,i.jsx)("span",{className:"font-bold text-lg",children:s.credits_remaining})]}),(0,i.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:(0,i.jsx)("div",{className:"h-2.5 rounded-full ".concat(s.credits_remaining<=1?"bg-red-600":s.credits_remaining<=3?"bg-yellow-500":"bg-green-600"),style:{width:"".concat(Math.min(s.credits_remaining/5*100,100),"%")}})}),(0,i.jsxs)("div",{className:"mt-3 text-sm text-gray-500",children:["Total itineraries created: ",s.total_credits_used||0]})]})]}):(0,i.jsx)("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded-lg",children:(0,i.jsx)("p",{className:"text-yellow-700",children:"Loading your credit information..."})})}function Dashboard(){var e;let{user:s,loading:r}=(0,l.a)(),n=(0,t.useRouter)(),d="success"===n.query.purchase;return r||s?r?(0,i.jsx)("div",{className:"min-h-screen bg-yellow-50 flex items-center justify-center",children:(0,i.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-indigo-900"})}):(0,i.jsx)("div",{className:"min-h-screen bg-yellow-50 py-12",children:(0,i.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,i.jsxs)("div",{className:"text-center mb-12",children:[(0,i.jsx)("h1",{className:"text-3xl font-bold text-indigo-900",children:"Welcome to Your Dashboard"}),(0,i.jsxs)("p",{className:"mt-2 text-gray-600",children:["Hello, ",(null==s?void 0:null===(e=s.user_metadata)||void 0===e?void 0:e.name)||(null==s?void 0:s.email),"!"]})]}),d&&(0,i.jsx)("div",{className:"max-w-3xl mx-auto mb-8",children:(0,i.jsx)("div",{className:"bg-green-50 border-l-4 border-green-400 p-4 rounded-lg",children:(0,i.jsxs)("div",{className:"flex",children:[(0,i.jsx)("div",{className:"flex-shrink-0",children:(0,i.jsx)("svg",{className:"h-5 w-5 text-green-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:(0,i.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}),(0,i.jsx)("div",{className:"ml-3",children:(0,i.jsx)("p",{className:"text-sm font-medium text-green-800",children:"Credit purchase successful! Your credits have been added to your account."})})]})})}),(0,i.jsx)("div",{className:"max-w-3xl mx-auto mb-8",children:(0,i.jsx)(UserCreditDisplay,{})}),(0,i.jsx)("div",{className:"max-w-3xl mx-auto mb-8",children:(0,i.jsx)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:(0,i.jsxs)("div",{className:"p-6",children:[(0,i.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Quick Actions"}),(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,i.jsxs)(a(),{href:"/trip-planner",className:"inline-flex items-center justify-center p-4 bg-indigo-50 rounded-lg text-indigo-700 hover:bg-indigo-100 transition",children:[(0,i.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Create New Trip"]}),(0,i.jsxs)(a(),{href:"/my-trips",className:"inline-flex items-center justify-center p-4 bg-purple-50 rounded-lg text-purple-700 hover:bg-purple-100 transition",children:[(0,i.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),"View My Trips"]})]})]})})}),(0,i.jsxs)("div",{className:"bg-white shadow rounded-lg p-6",children:[(0,i.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Your Trips"}),(0,i.jsxs)("div",{className:"text-center py-8",children:[(0,i.jsx)("p",{className:"text-gray-500 mb-4",children:"Ready to plan your next adventure?"}),(0,i.jsx)(a(),{href:"/trip-planner",className:"btn btn-primary bg-indigo-900 text-white px-4 py-2 rounded-md hover:bg-indigo-800",children:"Create a new trip"})]})]})]})}):(n.push("/auth/signin"),null)}}},function(e){e.O(0,[774,888,179],function(){return e(e.s=1075)}),_N_E=e.O()}]);