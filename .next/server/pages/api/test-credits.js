"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/test-credits";
exports.ids = ["pages/api/test-credits"];
exports.modules = {

/***/ "@supabase/supabase-js":
/*!****************************************!*\
  !*** external "@supabase/supabase-js" ***!
  \****************************************/
/***/ ((module) => {

module.exports = require("@supabase/supabase-js");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Ftest-credits&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Ftest-credits.js&middlewareConfigBase64=e30%3D!":
/*!******************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Ftest-credits&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Ftest-credits.js&middlewareConfigBase64=e30%3D! ***!
  \******************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_test_credits_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages/api/test-credits.js */ \"(api)/./pages/api/test-credits.js\");\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_test_credits_js__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_test_credits_js__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/test-credits\",\n        pathname: \"/api/test-credits\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_test_credits_js__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRnRlc3QtY3JlZGl0cyZwcmVmZXJyZWRSZWdpb249JmFic29sdXRlUGFnZVBhdGg9LiUyRnBhZ2VzJTJGYXBpJTJGdGVzdC1jcmVkaXRzLmpzJm1pZGRsZXdhcmVDb25maWdCYXNlNjQ9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNMO0FBQzFEO0FBQ3dEO0FBQ3hEO0FBQ0EsaUVBQWUsd0VBQUssQ0FBQyx1REFBUSxZQUFZLEVBQUM7QUFDMUM7QUFDTyxlQUFlLHdFQUFLLENBQUMsdURBQVE7QUFDcEM7QUFDTyx3QkFBd0IsZ0hBQW1CO0FBQ2xEO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLFlBQVk7QUFDWixDQUFDOztBQUVEIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2hpcC1mYXN0LWNvZGUvPzBmZGEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUGFnZXNBUElSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL3BhZ2VzLWFwaS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBob2lzdCB9IGZyb20gXCJuZXh0L2Rpc3QvYnVpbGQvdGVtcGxhdGVzL2hlbHBlcnNcIjtcbi8vIEltcG9ydCB0aGUgdXNlcmxhbmQgY29kZS5cbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIuL3BhZ2VzL2FwaS90ZXN0LWNyZWRpdHMuanNcIjtcbi8vIFJlLWV4cG9ydCB0aGUgaGFuZGxlciAoc2hvdWxkIGJlIHRoZSBkZWZhdWx0IGV4cG9ydCkuXG5leHBvcnQgZGVmYXVsdCBob2lzdCh1c2VybGFuZCwgXCJkZWZhdWx0XCIpO1xuLy8gUmUtZXhwb3J0IGNvbmZpZy5cbmV4cG9ydCBjb25zdCBjb25maWcgPSBob2lzdCh1c2VybGFuZCwgXCJjb25maWdcIik7XG4vLyBDcmVhdGUgYW5kIGV4cG9ydCB0aGUgcm91dGUgbW9kdWxlIHRoYXQgd2lsbCBiZSBjb25zdW1lZC5cbmV4cG9ydCBjb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBQYWdlc0FQSVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5QQUdFU19BUEksXG4gICAgICAgIHBhZ2U6IFwiL2FwaS90ZXN0LWNyZWRpdHNcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS90ZXN0LWNyZWRpdHNcIixcbiAgICAgICAgLy8gVGhlIGZvbGxvd2luZyBhcmVuJ3QgdXNlZCBpbiBwcm9kdWN0aW9uLlxuICAgICAgICBidW5kbGVQYXRoOiBcIlwiLFxuICAgICAgICBmaWxlbmFtZTogXCJcIlxuICAgIH0sXG4gICAgdXNlcmxhbmRcbn0pO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1wYWdlcy1hcGkuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Ftest-credits&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Ftest-credits.js&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./libs/creditSystem.js":
/*!******************************!*\
  !*** ./libs/creditSystem.js ***!
  \******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   addCredits: () => (/* binding */ addCredits),\n/* harmony export */   checkUserCredits: () => (/* binding */ checkUserCredits),\n/* harmony export */   deductCredits: () => (/* binding */ deductCredits),\n/* harmony export */   getUserCredits: () => (/* binding */ getUserCredits)\n/* harmony export */ });\n/* harmony import */ var _supabase__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./supabase */ \"(api)/./libs/supabase.js\");\n// libs/creditSystem.js\n\n/**\n * Check if a user has enough credits\n * @param {string} userId - User ID from Supabase\n * @param {number} requiredCredits - Number of credits needed (default: 1)\n * @returns {Promise<Object>} - Information about user's credits\n */ const checkUserCredits = async (userId, requiredCredits = 1)=>{\n    if (!userId) {\n        return {\n            hasEnoughCredits: false,\n            currentCredits: 0,\n            error: \"User ID is required\"\n        };\n    }\n    try {\n        // Fetch the user's current credits\n        const { data, error } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"user_credits\").select(\"*\").eq(\"user_id\", userId).single();\n        // If no record exists, create one with default values\n        if (error && error.code === \"PGRST116\") {\n            // Create a new record with default credits\n            const { data: newData, error: insertError } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"user_credits\").insert([\n                {\n                    user_id: userId,\n                    credits_remaining: 30,\n                    total_credits_used: 0,\n                    last_credit_reset: new Date().toISOString()\n                }\n            ]).select();\n            if (insertError) {\n                console.error(\"Error creating credit record:\", insertError);\n                return {\n                    hasEnoughCredits: false,\n                    currentCredits: 0,\n                    error: \"Failed to create credit record\"\n                };\n            }\n            return {\n                hasEnoughCredits: 30 >= requiredCredits,\n                currentCredits: 30,\n                resetDate: new Date().toISOString()\n            };\n        }\n        // Handle other errors\n        if (error) {\n            console.error(\"Error fetching credits:\", error);\n            return {\n                hasEnoughCredits: false,\n                currentCredits: 0,\n                error: \"Failed to check credits\"\n            };\n        }\n        // Check if credits need to be reset (monthly)\n        const lastReset = data.last_credit_reset ? new Date(data.last_credit_reset) : null;\n        const now = new Date();\n        // Reset credits if it's a new month (or never reset before)\n        if (!lastReset || lastReset.getMonth() !== now.getMonth() || lastReset.getFullYear() !== now.getFullYear()) {\n            // Reset to 30 credits at the beginning of each month\n            const { data: resetData, error: resetError } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"user_credits\").update({\n                credits_remaining: 30,\n                last_credit_reset: now.toISOString()\n            }).eq(\"user_id\", userId).select();\n            if (resetError) {\n                console.error(\"Error resetting credits:\", resetError);\n                return {\n                    hasEnoughCredits: data.credits_remaining >= requiredCredits,\n                    currentCredits: data.credits_remaining,\n                    error: \"Failed to reset monthly credits\"\n                };\n            }\n            // Return the updated credit information\n            return {\n                hasEnoughCredits: 30 >= requiredCredits,\n                currentCredits: 30,\n                resetDate: now.toISOString()\n            };\n        }\n        // Otherwise, return current credit status\n        return {\n            hasEnoughCredits: data.credits_remaining >= requiredCredits,\n            currentCredits: data.credits_remaining,\n            resetDate: data.last_credit_reset\n        };\n    } catch (error) {\n        console.error(\"Error in checkUserCredits:\", error);\n        return {\n            hasEnoughCredits: false,\n            currentCredits: 0,\n            error: error.message || \"Unknown error checking credits\"\n        };\n    }\n};\n/**\n * Deduct credits from a user\n * @param {string} userId - User ID from Supabase \n * @param {number} creditsToDeduct - Number of credits to use (default: 1)\n * @returns {Promise<Object>} - Result of the operation\n */ const deductCredits = async (userId, creditsToDeduct = 1)=>{\n    if (!userId) {\n        return {\n            success: false,\n            error: \"User ID is required\"\n        };\n    }\n    try {\n        // First check if user has enough credits\n        const { hasEnoughCredits, currentCredits, error } = await checkUserCredits(userId, creditsToDeduct);\n        if (error) {\n            return {\n                success: false,\n                error\n            };\n        }\n        if (!hasEnoughCredits) {\n            return {\n                success: false,\n                error: \"Not enough credits\",\n                currentCredits\n            };\n        }\n        // Deduct the credits\n        const { data, error: updateError } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"user_credits\").update({\n            credits_remaining: currentCredits - creditsToDeduct,\n            total_credits_used: _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.rpc(\"increment\", {\n                x: creditsToDeduct\n            })\n        }).eq(\"user_id\", userId).select();\n        if (updateError) {\n            console.error(\"Error deducting credits:\", updateError);\n            return {\n                success: false,\n                error: \"Failed to deduct credits\"\n            };\n        }\n        return {\n            success: true,\n            newCreditBalance: currentCredits - creditsToDeduct,\n            data\n        };\n    } catch (error) {\n        console.error(\"Error in deductCredits:\", error);\n        return {\n            success: false,\n            error: error.message || \"Unknown error deducting credits\"\n        };\n    }\n};\n/**\n * Add credits to a user\n * @param {string} userId - User ID from Supabase\n * @param {number} creditsToAdd - Number of credits to add\n * @returns {Promise<Object>} - Result of the operation\n */ const addCredits = async (userId, creditsToAdd = 1)=>{\n    if (!userId) {\n        return {\n            success: false,\n            error: \"User ID is required\"\n        };\n    }\n    try {\n        // Get current credits\n        const { currentCredits, error } = await checkUserCredits(userId, 0);\n        if (error) {\n            return {\n                success: false,\n                error\n            };\n        }\n        // Add the credits\n        const { data, error: updateError } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"user_credits\").update({\n            credits_remaining: currentCredits + creditsToAdd\n        }).eq(\"user_id\", userId).select();\n        if (updateError) {\n            console.error(\"Error adding credits:\", updateError);\n            return {\n                success: false,\n                error: \"Failed to add credits\"\n            };\n        }\n        return {\n            success: true,\n            newCreditBalance: currentCredits + creditsToAdd,\n            data\n        };\n    } catch (error) {\n        console.error(\"Error in addCredits:\", error);\n        return {\n            success: false,\n            error: error.message || \"Unknown error adding credits\"\n        };\n    }\n};\n/**\n * Get user credits\n * @param {string} userId - User ID from Supabase\n * @returns {Promise<Object>} - User's credit information\n */ const getUserCredits = async (userId)=>{\n    if (!userId) {\n        return {\n            success: false,\n            error: \"User ID is required\"\n        };\n    }\n    try {\n        const result = await checkUserCredits(userId, 0);\n        if (result.error) {\n            return {\n                success: false,\n                error: result.error\n            };\n        }\n        return {\n            success: true,\n            credits: {\n                credits_remaining: result.currentCredits,\n                total_credits_used: 0,\n                reset_date: result.resetDate\n            }\n        };\n    } catch (error) {\n        console.error(\"Error in getUserCredits:\", error);\n        return {\n            success: false,\n            error: error.message || \"Unknown error getting credits\"\n        };\n    }\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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UUFDRixNQUFNb0MsU0FBUyxNQUFNekMsaUJBQWlCQyxRQUFRO1FBRTlDLElBQUl3QyxPQUFPcEMsS0FBSyxFQUFFO1lBQ2hCLE9BQU87Z0JBQUU0QixTQUFTO2dCQUFPNUIsT0FBT29DLE9BQU9wQyxLQUFLO1lBQUM7UUFDL0M7UUFFQSxPQUFPO1lBQ0w0QixTQUFTO1lBQ1RTLFNBQVM7Z0JBQ1AxQixtQkFBbUJ5QixPQUFPckMsY0FBYztnQkFDeENhLG9CQUFvQjtnQkFDcEIwQixZQUFZRixPQUFPbkIsU0FBUztZQUM5QjtRQUNGO0lBQ0YsRUFBRSxPQUFPakIsT0FBTztRQUNkZ0IsUUFBUWhCLEtBQUssQ0FBQyw0QkFBNEJBO1FBQzFDLE9BQU87WUFDTDRCLFNBQVM7WUFDVDVCLE9BQU9BLE1BQU15QixPQUFPLElBQUk7UUFDMUI7SUFDRjtBQUNGLEVBQUUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zaGlwLWZhc3QtY29kZS8uL2xpYnMvY3JlZGl0U3lzdGVtLmpzP2JhZWYiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gbGlicy9jcmVkaXRTeXN0ZW0uanNcbmltcG9ydCB7IHN1cGFiYXNlIH0gZnJvbSAnLi9zdXBhYmFzZSc7XG5cbi8qKlxuICogQ2hlY2sgaWYgYSB1c2VyIGhhcyBlbm91Z2ggY3JlZGl0c1xuICogQHBhcmFtIHtzdHJpbmd9IHVzZXJJZCAtIFVzZXIgSUQgZnJvbSBTdXBhYmFzZVxuICogQHBhcmFtIHtudW1iZXJ9IHJlcXVpcmVkQ3JlZGl0cyAtIE51bWJlciBvZiBjcmVkaXRzIG5lZWRlZCAoZGVmYXVsdDogMSlcbiAqIEByZXR1cm5zIHtQcm9taXNlPE9iamVjdD59IC0gSW5mb3JtYXRpb24gYWJvdXQgdXNlcidzIGNyZWRpdHNcbiAqL1xuZXhwb3J0IGNvbnN0IGNoZWNrVXNlckNyZWRpdHMgPSBhc3luYyAodXNlcklkLCByZXF1aXJlZENyZWRpdHMgPSAxKSA9PiB7XG4gIGlmICghdXNlcklkKSB7XG4gICAgcmV0dXJuIHsgaGFzRW5vdWdoQ3JlZGl0czogZmFsc2UsIGN1cnJlbnRDcmVkaXRzOiAwLCBlcnJvcjogJ1VzZXIgSUQgaXMgcmVxdWlyZWQnIH07XG4gIH1cbiAgXG4gIHRyeSB7XG4gICAgLy8gRmV0Y2ggdGhlIHVzZXIncyBjdXJyZW50IGNyZWRpdHNcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgLmZyb20oJ3VzZXJfY3JlZGl0cycpXG4gICAgICAuc2VsZWN0KCcqJylcbiAgICAgIC5lcSgndXNlcl9pZCcsIHVzZXJJZClcbiAgICAgIC5zaW5nbGUoKTtcbiAgICBcbiAgICAvLyBJZiBubyByZWNvcmQgZXhpc3RzLCBjcmVhdGUgb25lIHdpdGggZGVmYXVsdCB2YWx1ZXNcbiAgICBpZiAoZXJyb3IgJiYgZXJyb3IuY29kZSA9PT0gJ1BHUlNUMTE2Jykge1xuICAgICAgLy8gQ3JlYXRlIGEgbmV3IHJlY29yZCB3aXRoIGRlZmF1bHQgY3JlZGl0c1xuICAgICAgY29uc3QgeyBkYXRhOiBuZXdEYXRhLCBlcnJvcjogaW5zZXJ0RXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCd1c2VyX2NyZWRpdHMnKVxuICAgICAgICAuaW5zZXJ0KFt7XG4gICAgICAgICAgdXNlcl9pZDogdXNlcklkLFxuICAgICAgICAgIGNyZWRpdHNfcmVtYWluaW5nOiAzMCwgLy8gU3RhcnQgd2l0aCAzMCBmcmVlIGNyZWRpdHNcbiAgICAgICAgICB0b3RhbF9jcmVkaXRzX3VzZWQ6IDAsXG4gICAgICAgICAgbGFzdF9jcmVkaXRfcmVzZXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICAgICAgICB9XSlcbiAgICAgICAgLnNlbGVjdCgpO1xuICAgICAgXG4gICAgICBpZiAoaW5zZXJ0RXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgY3JlZGl0IHJlY29yZDonLCBpbnNlcnRFcnJvcik7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgaGFzRW5vdWdoQ3JlZGl0czogZmFsc2UsXG4gICAgICAgICAgY3VycmVudENyZWRpdHM6IDAsXG4gICAgICAgICAgZXJyb3I6ICdGYWlsZWQgdG8gY3JlYXRlIGNyZWRpdCByZWNvcmQnXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgICBcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGhhc0Vub3VnaENyZWRpdHM6IDMwID49IHJlcXVpcmVkQ3JlZGl0cyxcbiAgICAgICAgY3VycmVudENyZWRpdHM6IDMwLFxuICAgICAgICByZXNldERhdGU6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICAgICAgfTtcbiAgICB9XG4gICAgXG4gICAgLy8gSGFuZGxlIG90aGVyIGVycm9yc1xuICAgIGlmIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgY3JlZGl0czonLCBlcnJvcik7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBoYXNFbm91Z2hDcmVkaXRzOiBmYWxzZSxcbiAgICAgICAgY3VycmVudENyZWRpdHM6IDAsXG4gICAgICAgIGVycm9yOiAnRmFpbGVkIHRvIGNoZWNrIGNyZWRpdHMnXG4gICAgICB9O1xuICAgIH1cbiAgICBcbiAgICAvLyBDaGVjayBpZiBjcmVkaXRzIG5lZWQgdG8gYmUgcmVzZXQgKG1vbnRobHkpXG4gICAgY29uc3QgbGFzdFJlc2V0ID0gZGF0YS5sYXN0X2NyZWRpdF9yZXNldCA/IG5ldyBEYXRlKGRhdGEubGFzdF9jcmVkaXRfcmVzZXQpIDogbnVsbDtcbiAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpO1xuICAgIFxuICAgIC8vIFJlc2V0IGNyZWRpdHMgaWYgaXQncyBhIG5ldyBtb250aCAob3IgbmV2ZXIgcmVzZXQgYmVmb3JlKVxuICAgIGlmICghbGFzdFJlc2V0IHx8IFxuICAgICAgICBsYXN0UmVzZXQuZ2V0TW9udGgoKSAhPT0gbm93LmdldE1vbnRoKCkgfHwgXG4gICAgICAgIGxhc3RSZXNldC5nZXRGdWxsWWVhcigpICE9PSBub3cuZ2V0RnVsbFllYXIoKSkge1xuICAgICAgXG4gICAgICAvLyBSZXNldCB0byAzMCBjcmVkaXRzIGF0IHRoZSBiZWdpbm5pbmcgb2YgZWFjaCBtb250aFxuICAgICAgY29uc3QgeyBkYXRhOiByZXNldERhdGEsIGVycm9yOiByZXNldEVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgndXNlcl9jcmVkaXRzJylcbiAgICAgICAgLnVwZGF0ZSh7XG4gICAgICAgICAgY3JlZGl0c19yZW1haW5pbmc6IDMwLFxuICAgICAgICAgIGxhc3RfY3JlZGl0X3Jlc2V0OiBub3cudG9JU09TdHJpbmcoKVxuICAgICAgICB9KVxuICAgICAgICAuZXEoJ3VzZXJfaWQnLCB1c2VySWQpXG4gICAgICAgIC5zZWxlY3QoKTtcbiAgICAgIFxuICAgICAgaWYgKHJlc2V0RXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgcmVzZXR0aW5nIGNyZWRpdHM6JywgcmVzZXRFcnJvcik7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgaGFzRW5vdWdoQ3JlZGl0czogZGF0YS5jcmVkaXRzX3JlbWFpbmluZyA+PSByZXF1aXJlZENyZWRpdHMsXG4gICAgICAgICAgY3VycmVudENyZWRpdHM6IGRhdGEuY3JlZGl0c19yZW1haW5pbmcsXG4gICAgICAgICAgZXJyb3I6ICdGYWlsZWQgdG8gcmVzZXQgbW9udGhseSBjcmVkaXRzJ1xuICAgICAgICB9O1xuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBSZXR1cm4gdGhlIHVwZGF0ZWQgY3JlZGl0IGluZm9ybWF0aW9uXG4gICAgICByZXR1cm4ge1xuICAgICAgICBoYXNFbm91Z2hDcmVkaXRzOiAzMCA+PSByZXF1aXJlZENyZWRpdHMsXG4gICAgICAgIGN1cnJlbnRDcmVkaXRzOiAzMCxcbiAgICAgICAgcmVzZXREYXRlOiBub3cudG9JU09TdHJpbmcoKVxuICAgICAgfTtcbiAgICB9XG4gICAgXG4gICAgLy8gT3RoZXJ3aXNlLCByZXR1cm4gY3VycmVudCBjcmVkaXQgc3RhdHVzXG4gICAgcmV0dXJuIHtcbiAgICAgIGhhc0Vub3VnaENyZWRpdHM6IGRhdGEuY3JlZGl0c19yZW1haW5pbmcgPj0gcmVxdWlyZWRDcmVkaXRzLFxuICAgICAgY3VycmVudENyZWRpdHM6IGRhdGEuY3JlZGl0c19yZW1haW5pbmcsXG4gICAgICByZXNldERhdGU6IGRhdGEubGFzdF9jcmVkaXRfcmVzZXRcbiAgICB9O1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluIGNoZWNrVXNlckNyZWRpdHM6JywgZXJyb3IpO1xuICAgIHJldHVybiB7XG4gICAgICBoYXNFbm91Z2hDcmVkaXRzOiBmYWxzZSxcbiAgICAgIGN1cnJlbnRDcmVkaXRzOiAwLFxuICAgICAgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfHwgJ1Vua25vd24gZXJyb3IgY2hlY2tpbmcgY3JlZGl0cydcbiAgICB9O1xuICB9XG59O1xuXG4vKipcbiAqIERlZHVjdCBjcmVkaXRzIGZyb20gYSB1c2VyXG4gKiBAcGFyYW0ge3N0cmluZ30gdXNlcklkIC0gVXNlciBJRCBmcm9tIFN1cGFiYXNlIFxuICogQHBhcmFtIHtudW1iZXJ9IGNyZWRpdHNUb0RlZHVjdCAtIE51bWJlciBvZiBjcmVkaXRzIHRvIHVzZSAoZGVmYXVsdDogMSlcbiAqIEByZXR1cm5zIHtQcm9taXNlPE9iamVjdD59IC0gUmVzdWx0IG9mIHRoZSBvcGVyYXRpb25cbiAqL1xuZXhwb3J0IGNvbnN0IGRlZHVjdENyZWRpdHMgPSBhc3luYyAodXNlcklkLCBjcmVkaXRzVG9EZWR1Y3QgPSAxKSA9PiB7XG4gIGlmICghdXNlcklkKSB7XG4gICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnVXNlciBJRCBpcyByZXF1aXJlZCcgfTtcbiAgfVxuICBcbiAgdHJ5IHtcbiAgICAvLyBGaXJzdCBjaGVjayBpZiB1c2VyIGhhcyBlbm91Z2ggY3JlZGl0c1xuICAgIGNvbnN0IHsgaGFzRW5vdWdoQ3JlZGl0cywgY3VycmVudENyZWRpdHMsIGVycm9yIH0gPSBhd2FpdCBjaGVja1VzZXJDcmVkaXRzKHVzZXJJZCwgY3JlZGl0c1RvRGVkdWN0KTtcbiAgICBcbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvciB9O1xuICAgIH1cbiAgICBcbiAgICBpZiAoIWhhc0Vub3VnaENyZWRpdHMpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjogJ05vdCBlbm91Z2ggY3JlZGl0cycsXG4gICAgICAgIGN1cnJlbnRDcmVkaXRzXG4gICAgICB9O1xuICAgIH1cbiAgICBcbiAgICAvLyBEZWR1Y3QgdGhlIGNyZWRpdHNcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yOiB1cGRhdGVFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgIC5mcm9tKCd1c2VyX2NyZWRpdHMnKVxuICAgICAgLnVwZGF0ZSh7XG4gICAgICAgIGNyZWRpdHNfcmVtYWluaW5nOiBjdXJyZW50Q3JlZGl0cyAtIGNyZWRpdHNUb0RlZHVjdCxcbiAgICAgICAgdG90YWxfY3JlZGl0c191c2VkOiBzdXBhYmFzZS5ycGMoJ2luY3JlbWVudCcsIHsgeDogY3JlZGl0c1RvRGVkdWN0IH0pXG4gICAgICB9KVxuICAgICAgLmVxKCd1c2VyX2lkJywgdXNlcklkKVxuICAgICAgLnNlbGVjdCgpO1xuICAgIFxuICAgIGlmICh1cGRhdGVFcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZGVkdWN0aW5nIGNyZWRpdHM6JywgdXBkYXRlRXJyb3IpO1xuICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnRmFpbGVkIHRvIGRlZHVjdCBjcmVkaXRzJyB9O1xuICAgIH1cbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIG5ld0NyZWRpdEJhbGFuY2U6IGN1cnJlbnRDcmVkaXRzIC0gY3JlZGl0c1RvRGVkdWN0LFxuICAgICAgZGF0YVxuICAgIH07XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgaW4gZGVkdWN0Q3JlZGl0czonLCBlcnJvcik7XG4gICAgcmV0dXJuIHtcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfHwgJ1Vua25vd24gZXJyb3IgZGVkdWN0aW5nIGNyZWRpdHMnXG4gICAgfTtcbiAgfVxufTtcblxuLyoqXG4gKiBBZGQgY3JlZGl0cyB0byBhIHVzZXJcbiAqIEBwYXJhbSB7c3RyaW5nfSB1c2VySWQgLSBVc2VyIElEIGZyb20gU3VwYWJhc2VcbiAqIEBwYXJhbSB7bnVtYmVyfSBjcmVkaXRzVG9BZGQgLSBOdW1iZXIgb2YgY3JlZGl0cyB0byBhZGRcbiAqIEByZXR1cm5zIHtQcm9taXNlPE9iamVjdD59IC0gUmVzdWx0IG9mIHRoZSBvcGVyYXRpb25cbiAqL1xuZXhwb3J0IGNvbnN0IGFkZENyZWRpdHMgPSBhc3luYyAodXNlcklkLCBjcmVkaXRzVG9BZGQgPSAxKSA9PiB7XG4gIGlmICghdXNlcklkKSB7XG4gICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnVXNlciBJRCBpcyByZXF1aXJlZCcgfTtcbiAgfVxuICBcbiAgdHJ5IHtcbiAgICAvLyBHZXQgY3VycmVudCBjcmVkaXRzXG4gICAgY29uc3QgeyBjdXJyZW50Q3JlZGl0cywgZXJyb3IgfSA9IGF3YWl0IGNoZWNrVXNlckNyZWRpdHModXNlcklkLCAwKTtcbiAgICBcbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvciB9O1xuICAgIH1cbiAgICBcbiAgICAvLyBBZGQgdGhlIGNyZWRpdHNcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yOiB1cGRhdGVFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgIC5mcm9tKCd1c2VyX2NyZWRpdHMnKVxuICAgICAgLnVwZGF0ZSh7XG4gICAgICAgIGNyZWRpdHNfcmVtYWluaW5nOiBjdXJyZW50Q3JlZGl0cyArIGNyZWRpdHNUb0FkZFxuICAgICAgfSlcbiAgICAgIC5lcSgndXNlcl9pZCcsIHVzZXJJZClcbiAgICAgIC5zZWxlY3QoKTtcbiAgICBcbiAgICBpZiAodXBkYXRlRXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGFkZGluZyBjcmVkaXRzOicsIHVwZGF0ZUVycm9yKTtcbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0ZhaWxlZCB0byBhZGQgY3JlZGl0cycgfTtcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBuZXdDcmVkaXRCYWxhbmNlOiBjdXJyZW50Q3JlZGl0cyArIGNyZWRpdHNUb0FkZCxcbiAgICAgIGRhdGFcbiAgICB9O1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluIGFkZENyZWRpdHM6JywgZXJyb3IpO1xuICAgIHJldHVybiB7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIGVycm9yOiBlcnJvci5tZXNzYWdlIHx8ICdVbmtub3duIGVycm9yIGFkZGluZyBjcmVkaXRzJ1xuICAgIH07XG4gIH1cbn07XG5cbi8qKlxuICogR2V0IHVzZXIgY3JlZGl0c1xuICogQHBhcmFtIHtzdHJpbmd9IHVzZXJJZCAtIFVzZXIgSUQgZnJvbSBTdXBhYmFzZVxuICogQHJldHVybnMge1Byb21pc2U8T2JqZWN0Pn0gLSBVc2VyJ3MgY3JlZGl0IGluZm9ybWF0aW9uXG4gKi9cbmV4cG9ydCBjb25zdCBnZXRVc2VyQ3JlZGl0cyA9IGFzeW5jICh1c2VySWQpID0+IHtcbiAgaWYgKCF1c2VySWQpIHtcbiAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdVc2VyIElEIGlzIHJlcXVpcmVkJyB9O1xuICB9XG4gIFxuICB0cnkge1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNoZWNrVXNlckNyZWRpdHModXNlcklkLCAwKTtcbiAgICBcbiAgICBpZiAocmVzdWx0LmVycm9yKSB7XG4gICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IHJlc3VsdC5lcnJvciB9O1xuICAgIH1cbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIGNyZWRpdHM6IHtcbiAgICAgICAgY3JlZGl0c19yZW1haW5pbmc6IHJlc3VsdC5jdXJyZW50Q3JlZGl0cyxcbiAgICAgICAgdG90YWxfY3JlZGl0c191c2VkOiAwLCAvLyBUaGlzIHdvdWxkIG5lZWQgdG8gYmUgaW5jbHVkZWQgaW4gdGhlIGNoZWNrVXNlckNyZWRpdHMgcmVzcG9uc2VcbiAgICAgICAgcmVzZXRfZGF0ZTogcmVzdWx0LnJlc2V0RGF0ZVxuICAgICAgfVxuICAgIH07XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgaW4gZ2V0VXNlckNyZWRpdHM6JywgZXJyb3IpO1xuICAgIHJldHVybiB7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIGVycm9yOiBlcnJvci5tZXNzYWdlIHx8ICdVbmtub3duIGVycm9yIGdldHRpbmcgY3JlZGl0cydcbiAgICB9O1xuICB9XG59OyJdLCJuYW1lcyI6WyJzdXBhYmFzZSIsImNoZWNrVXNlckNyZWRpdHMiLCJ1c2VySWQiLCJyZXF1aXJlZENyZWRpdHMiLCJoYXNFbm91Z2hDcmVkaXRzIiwiY3VycmVudENyZWRpdHMiLCJlcnJvciIsImRhdGEiLCJmcm9tIiwic2VsZWN0IiwiZXEiLCJzaW5nbGUiLCJjb2RlIiwibmV3RGF0YSIsImluc2VydEVycm9yIiwiaW5zZXJ0IiwidXNlcl9pZCIsImNyZWRpdHNfcmVtYWluaW5nIiwidG90YWxfY3JlZGl0c191c2VkIiwibGFzdF9jcmVkaXRfcmVzZXQiLCJEYXRlIiwidG9JU09TdHJpbmciLCJjb25zb2xlIiwicmVzZXREYXRlIiwibGFzdFJlc2V0Iiwibm93IiwiZ2V0TW9udGgiLCJnZXRGdWxsWWVhciIsInJlc2V0RGF0YSIsInJlc2V0RXJyb3IiLCJ1cGRhdGUiLCJtZXNzYWdlIiwiZGVkdWN0Q3JlZGl0cyIsImNyZWRpdHNUb0RlZHVjdCIsInN1Y2Nlc3MiLCJ1cGRhdGVFcnJvciIsInJwYyIsIngiLCJuZXdDcmVkaXRCYWxhbmNlIiwiYWRkQ3JlZGl0cyIsImNyZWRpdHNUb0FkZCIsImdldFVzZXJDcmVkaXRzIiwicmVzdWx0IiwiY3JlZGl0cyIsInJlc2V0X2RhdGUiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./libs/creditSystem.js\n");

/***/ }),

/***/ "(api)/./libs/supabase.js":
/*!**************************!*\
  !*** ./libs/supabase.js ***!
  \**************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   supabase: () => (/* binding */ supabase)\n/* harmony export */ });\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/supabase-js */ \"@supabase/supabase-js\");\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__);\n// // libs/supabase.js\n// import { createClient } from '@supabase/supabase-js'\n// // Create a single supabase client for interacting with your database\n// const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL\n// const supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY\n// export const supabase = createClient(supabaseUrl, supabaseAnonKey)\n// // Admin client with service role for server-side operations\n// export const getServiceSupabase = () => {\n//   const supabaseServiceKey = process.env.SUPABASE_SERVICE_ROLE_KEY\n//   return createClient(supabaseUrl, supabaseServiceKey)\n// }\n// libs/supabase.js\n\nconst supabaseUrl = \"https://qlcenpzwdvvtcnblixyp.supabase.co\";\nconst supabaseAnonKey = \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFsY2VucHp3ZHZ2dGNuYmxpeHlwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDYzOTY4MTMsImV4cCI6MjA2MTk3MjgxM30.B332OjGROnVxsSKra9T_Uh6fQvVdhOH21z7731pc1Kk\";\n// Create a single supabase client for interacting with your database\nconst supabase = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(supabaseUrl, supabaseAnonKey, {\n    auth: {\n        persistSession: true,\n        autoRefreshToken: true,\n        detectSessionInUrl: true,\n        // Make sure we're using cookie storage for better compatibility with API routes\n        storage: {\n            getItem: (key)=>{\n                // When running on the server, there is no localStorage\n                if (true) {\n                    return null;\n                }\n                return JSON.parse(window.localStorage.getItem(key) || \"null\");\n            },\n            setItem: (key, value)=>{\n                if (false) {}\n            },\n            removeItem: (key)=>{\n                if (false) {}\n            }\n        }\n    }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9saWJzL3N1cGFiYXNlLmpzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLHNCQUFzQjtBQUN0Qix1REFBdUQ7QUFFdkQsd0VBQXdFO0FBQ3hFLDJEQUEyRDtBQUMzRCxvRUFBb0U7QUFFcEUscUVBQXFFO0FBRXJFLCtEQUErRDtBQUMvRCw0Q0FBNEM7QUFDNUMscUVBQXFFO0FBQ3JFLHlEQUF5RDtBQUN6RCxJQUFJO0FBQ0osbUJBQW1CO0FBQ2lDO0FBRXBELE1BQU1DLGNBQWNDLDBDQUFvQztBQUN4RCxNQUFNRyxrQkFBa0JILGtOQUF5QztBQUVqRSxxRUFBcUU7QUFDOUQsTUFBTUssV0FBV1AsbUVBQVlBLENBQUNDLGFBQWFJLGlCQUFpQjtJQUNqRUcsTUFBTTtRQUNKQyxnQkFBZ0I7UUFDaEJDLGtCQUFrQjtRQUNsQkMsb0JBQW9CO1FBQ3BCLGdGQUFnRjtRQUNoRkMsU0FBUztZQUNQQyxTQUFTLENBQUNDO2dCQUNSLHVEQUF1RDtnQkFDdkQsSUFBSSxJQUFrQixFQUFhO29CQUNqQyxPQUFPO2dCQUNUO2dCQUNBLE9BQU9DLEtBQUtDLEtBQUssQ0FBQ0MsT0FBT0MsWUFBWSxDQUFDTCxPQUFPLENBQUNDLFFBQVE7WUFDeEQ7WUFDQUssU0FBUyxDQUFDTCxLQUFLTTtnQkFDYixJQUFJLEtBQWtCLEVBQWEsRUFFbEM7WUFDSDtZQUNBRSxZQUFZLENBQUNSO2dCQUNYLElBQUksS0FBa0IsRUFBYSxFQUVsQztZQUNIO1FBQ0Y7SUFDRjtBQUNGLEdBQUUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zaGlwLWZhc3QtY29kZS8uL2xpYnMvc3VwYWJhc2UuanM/ZTY5ZCJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyAvLyBsaWJzL3N1cGFiYXNlLmpzXG4vLyBpbXBvcnQgeyBjcmVhdGVDbGllbnQgfSBmcm9tICdAc3VwYWJhc2Uvc3VwYWJhc2UtanMnXG5cbi8vIC8vIENyZWF0ZSBhIHNpbmdsZSBzdXBhYmFzZSBjbGllbnQgZm9yIGludGVyYWN0aW5nIHdpdGggeW91ciBkYXRhYmFzZVxuLy8gY29uc3Qgc3VwYWJhc2VVcmwgPSBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkxcbi8vIGNvbnN0IHN1cGFiYXNlQW5vbktleSA9IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX0FOT05fS0VZXG5cbi8vIGV4cG9ydCBjb25zdCBzdXBhYmFzZSA9IGNyZWF0ZUNsaWVudChzdXBhYmFzZVVybCwgc3VwYWJhc2VBbm9uS2V5KVxuXG4vLyAvLyBBZG1pbiBjbGllbnQgd2l0aCBzZXJ2aWNlIHJvbGUgZm9yIHNlcnZlci1zaWRlIG9wZXJhdGlvbnNcbi8vIGV4cG9ydCBjb25zdCBnZXRTZXJ2aWNlU3VwYWJhc2UgPSAoKSA9PiB7XG4vLyAgIGNvbnN0IHN1cGFiYXNlU2VydmljZUtleSA9IHByb2Nlc3MuZW52LlNVUEFCQVNFX1NFUlZJQ0VfUk9MRV9LRVlcbi8vICAgcmV0dXJuIGNyZWF0ZUNsaWVudChzdXBhYmFzZVVybCwgc3VwYWJhc2VTZXJ2aWNlS2V5KVxuLy8gfVxuLy8gbGlicy9zdXBhYmFzZS5qc1xuaW1wb3J0IHsgY3JlYXRlQ2xpZW50IH0gZnJvbSAnQHN1cGFiYXNlL3N1cGFiYXNlLWpzJ1xuXG5jb25zdCBzdXBhYmFzZVVybCA9IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTFxuY29uc3Qgc3VwYWJhc2VBbm9uS2V5ID0gcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfQU5PTl9LRVlcblxuLy8gQ3JlYXRlIGEgc2luZ2xlIHN1cGFiYXNlIGNsaWVudCBmb3IgaW50ZXJhY3Rpbmcgd2l0aCB5b3VyIGRhdGFiYXNlXG5leHBvcnQgY29uc3Qgc3VwYWJhc2UgPSBjcmVhdGVDbGllbnQoc3VwYWJhc2VVcmwsIHN1cGFiYXNlQW5vbktleSwge1xuICBhdXRoOiB7XG4gICAgcGVyc2lzdFNlc3Npb246IHRydWUsXG4gICAgYXV0b1JlZnJlc2hUb2tlbjogdHJ1ZSxcbiAgICBkZXRlY3RTZXNzaW9uSW5Vcmw6IHRydWUsXG4gICAgLy8gTWFrZSBzdXJlIHdlJ3JlIHVzaW5nIGNvb2tpZSBzdG9yYWdlIGZvciBiZXR0ZXIgY29tcGF0aWJpbGl0eSB3aXRoIEFQSSByb3V0ZXNcbiAgICBzdG9yYWdlOiB7XG4gICAgICBnZXRJdGVtOiAoa2V5KSA9PiB7XG4gICAgICAgIC8vIFdoZW4gcnVubmluZyBvbiB0aGUgc2VydmVyLCB0aGVyZSBpcyBubyBsb2NhbFN0b3JhZ2VcbiAgICAgICAgaWYgKHR5cGVvZiB3aW5kb3cgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIEpTT04ucGFyc2Uod2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKGtleSkgfHwgJ251bGwnKTtcbiAgICAgIH0sXG4gICAgICBzZXRJdGVtOiAoa2V5LCB2YWx1ZSkgPT4ge1xuICAgICAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLnNldEl0ZW0oa2V5LCBKU09OLnN0cmluZ2lmeSh2YWx1ZSkpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgcmVtb3ZlSXRlbTogKGtleSkgPT4ge1xuICAgICAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oa2V5KTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICB9LFxuICB9LFxufSkiXSwibmFtZXMiOlsiY3JlYXRlQ2xpZW50Iiwic3VwYWJhc2VVcmwiLCJwcm9jZXNzIiwiZW52IiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMIiwic3VwYWJhc2VBbm9uS2V5IiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfQU5PTl9LRVkiLCJzdXBhYmFzZSIsImF1dGgiLCJwZXJzaXN0U2Vzc2lvbiIsImF1dG9SZWZyZXNoVG9rZW4iLCJkZXRlY3RTZXNzaW9uSW5VcmwiLCJzdG9yYWdlIiwiZ2V0SXRlbSIsImtleSIsIkpTT04iLCJwYXJzZSIsIndpbmRvdyIsImxvY2FsU3RvcmFnZSIsInNldEl0ZW0iLCJ2YWx1ZSIsInN0cmluZ2lmeSIsInJlbW92ZUl0ZW0iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./libs/supabase.js\n");

/***/ }),

/***/ "(api)/./pages/api/test-credits.js":
/*!***********************************!*\
  !*** ./pages/api/test-credits.js ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var _libs_supabase__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/libs/supabase */ \"(api)/./libs/supabase.js\");\n/* harmony import */ var _libs_creditSystem__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/libs/creditSystem */ \"(api)/./libs/creditSystem.js\");\n// pages/api/test-credits.js\n\n\nasync function handler(req, res) {\n    // Check authentication\n    const { data: { session }, error: authError } = await _libs_supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.auth.getSession();\n    if (authError || !session) {\n        return res.status(401).json({\n            error: \"Not authenticated\"\n        });\n    }\n    const userId = session.user.id;\n    try {\n        switch(req.method){\n            case \"GET\":\n                // Get current credit status\n                const creditCheck = await (0,_libs_creditSystem__WEBPACK_IMPORTED_MODULE_1__.checkUserCredits)(userId, 0);\n                return res.status(200).json({\n                    success: true,\n                    credits: creditCheck.currentCredits,\n                    hasEnoughCredits: creditCheck.hasEnoughCredits,\n                    resetDate: creditCheck.resetDate\n                });\n            case \"POST\":\n                const { action, amount = 1 } = req.body;\n                if (action === \"deduct\") {\n                    // Test deducting credits\n                    const result = await (0,_libs_creditSystem__WEBPACK_IMPORTED_MODULE_1__.deductCredits)(userId, amount);\n                    return res.status(200).json(result);\n                } else if (action === \"add\") {\n                    // Test adding credits\n                    const result = await (0,_libs_creditSystem__WEBPACK_IMPORTED_MODULE_1__.addCredits)(userId, amount);\n                    return res.status(200).json(result);\n                } else {\n                    return res.status(400).json({\n                        error: 'Invalid action. Use \"deduct\" or \"add\"'\n                    });\n                }\n            default:\n                return res.status(405).json({\n                    error: \"Method not allowed\"\n                });\n        }\n    } catch (error) {\n        console.error(\"Test credits API error:\", error);\n        return res.status(500).json({\n            error: error.message\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9wYWdlcy9hcGkvdGVzdC1jcmVkaXRzLmpzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLDRCQUE0QjtBQUNlO0FBQ3VDO0FBRW5FLGVBQWVJLFFBQVFDLEdBQUcsRUFBRUMsR0FBRztJQUM1Qyx1QkFBdUI7SUFDdkIsTUFBTSxFQUFFQyxNQUFNLEVBQUVDLE9BQU8sRUFBRSxFQUFFQyxPQUFPQyxTQUFTLEVBQUUsR0FBRyxNQUFNVixvREFBUUEsQ0FBQ1csSUFBSSxDQUFDQyxVQUFVO0lBRTlFLElBQUlGLGFBQWEsQ0FBQ0YsU0FBUztRQUN6QixPQUFPRixJQUFJTyxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO1lBQUVMLE9BQU87UUFBb0I7SUFDM0Q7SUFFQSxNQUFNTSxTQUFTUCxRQUFRUSxJQUFJLENBQUNDLEVBQUU7SUFFOUIsSUFBSTtRQUNGLE9BQVFaLElBQUlhLE1BQU07WUFDaEIsS0FBSztnQkFDSCw0QkFBNEI7Z0JBQzVCLE1BQU1DLGNBQWMsTUFBTWxCLG9FQUFnQkEsQ0FBQ2MsUUFBUTtnQkFDbkQsT0FBT1QsSUFBSU8sTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztvQkFDMUJNLFNBQVM7b0JBQ1RDLFNBQVNGLFlBQVlHLGNBQWM7b0JBQ25DQyxrQkFBa0JKLFlBQVlJLGdCQUFnQjtvQkFDOUNDLFdBQVdMLFlBQVlLLFNBQVM7Z0JBQ2xDO1lBRUYsS0FBSztnQkFDSCxNQUFNLEVBQUVDLE1BQU0sRUFBRUMsU0FBUyxDQUFDLEVBQUUsR0FBR3JCLElBQUlzQixJQUFJO2dCQUV2QyxJQUFJRixXQUFXLFVBQVU7b0JBQ3ZCLHlCQUF5QjtvQkFDekIsTUFBTUcsU0FBUyxNQUFNMUIsaUVBQWFBLENBQUNhLFFBQVFXO29CQUMzQyxPQUFPcEIsSUFBSU8sTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQ2M7Z0JBQzlCLE9BQU8sSUFBSUgsV0FBVyxPQUFPO29CQUMzQixzQkFBc0I7b0JBQ3RCLE1BQU1HLFNBQVMsTUFBTXpCLDhEQUFVQSxDQUFDWSxRQUFRVztvQkFDeEMsT0FBT3BCLElBQUlPLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUNjO2dCQUM5QixPQUFPO29CQUNMLE9BQU90QixJQUFJTyxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO3dCQUFFTCxPQUFPO29CQUF3QztnQkFDL0U7WUFFRjtnQkFDRSxPQUFPSCxJQUFJTyxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO29CQUFFTCxPQUFPO2dCQUFxQjtRQUM5RDtJQUNGLEVBQUUsT0FBT0EsT0FBTztRQUNkb0IsUUFBUXBCLEtBQUssQ0FBQywyQkFBMkJBO1FBQ3pDLE9BQU9ILElBQUlPLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7WUFBRUwsT0FBT0EsTUFBTXFCLE9BQU87UUFBQztJQUNyRDtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2hpcC1mYXN0LWNvZGUvLi9wYWdlcy9hcGkvdGVzdC1jcmVkaXRzLmpzPzczMjAiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gcGFnZXMvYXBpL3Rlc3QtY3JlZGl0cy5qc1xuaW1wb3J0IHsgc3VwYWJhc2UgfSBmcm9tICdAL2xpYnMvc3VwYWJhc2UnO1xuaW1wb3J0IHsgY2hlY2tVc2VyQ3JlZGl0cywgZGVkdWN0Q3JlZGl0cywgYWRkQ3JlZGl0cyB9IGZyb20gJ0AvbGlicy9jcmVkaXRTeXN0ZW0nO1xuXG5leHBvcnQgZGVmYXVsdCBhc3luYyBmdW5jdGlvbiBoYW5kbGVyKHJlcSwgcmVzKSB7XG4gIC8vIENoZWNrIGF1dGhlbnRpY2F0aW9uXG4gIGNvbnN0IHsgZGF0YTogeyBzZXNzaW9uIH0sIGVycm9yOiBhdXRoRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlLmF1dGguZ2V0U2Vzc2lvbigpO1xuICBcbiAgaWYgKGF1dGhFcnJvciB8fCAhc2Vzc2lvbikge1xuICAgIHJldHVybiByZXMuc3RhdHVzKDQwMSkuanNvbih7IGVycm9yOiAnTm90IGF1dGhlbnRpY2F0ZWQnIH0pO1xuICB9XG4gIFxuICBjb25zdCB1c2VySWQgPSBzZXNzaW9uLnVzZXIuaWQ7XG4gIFxuICB0cnkge1xuICAgIHN3aXRjaCAocmVxLm1ldGhvZCkge1xuICAgICAgY2FzZSAnR0VUJzpcbiAgICAgICAgLy8gR2V0IGN1cnJlbnQgY3JlZGl0IHN0YXR1c1xuICAgICAgICBjb25zdCBjcmVkaXRDaGVjayA9IGF3YWl0IGNoZWNrVXNlckNyZWRpdHModXNlcklkLCAwKTtcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5qc29uKHtcbiAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgIGNyZWRpdHM6IGNyZWRpdENoZWNrLmN1cnJlbnRDcmVkaXRzLFxuICAgICAgICAgIGhhc0Vub3VnaENyZWRpdHM6IGNyZWRpdENoZWNrLmhhc0Vub3VnaENyZWRpdHMsXG4gICAgICAgICAgcmVzZXREYXRlOiBjcmVkaXRDaGVjay5yZXNldERhdGVcbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgY2FzZSAnUE9TVCc6XG4gICAgICAgIGNvbnN0IHsgYWN0aW9uLCBhbW91bnQgPSAxIH0gPSByZXEuYm9keTtcbiAgICAgICAgXG4gICAgICAgIGlmIChhY3Rpb24gPT09ICdkZWR1Y3QnKSB7XG4gICAgICAgICAgLy8gVGVzdCBkZWR1Y3RpbmcgY3JlZGl0c1xuICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRlZHVjdENyZWRpdHModXNlcklkLCBhbW91bnQpO1xuICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuanNvbihyZXN1bHQpO1xuICAgICAgICB9IGVsc2UgaWYgKGFjdGlvbiA9PT0gJ2FkZCcpIHtcbiAgICAgICAgICAvLyBUZXN0IGFkZGluZyBjcmVkaXRzXG4gICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgYWRkQ3JlZGl0cyh1c2VySWQsIGFtb3VudCk7XG4gICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5qc29uKHJlc3VsdCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgZXJyb3I6ICdJbnZhbGlkIGFjdGlvbi4gVXNlIFwiZGVkdWN0XCIgb3IgXCJhZGRcIicgfSk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICBkZWZhdWx0OlxuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDUpLmpzb24oeyBlcnJvcjogJ01ldGhvZCBub3QgYWxsb3dlZCcgfSk7XG4gICAgfVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ1Rlc3QgY3JlZGl0cyBBUEkgZXJyb3I6JywgZXJyb3IpO1xuICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiBlcnJvci5tZXNzYWdlIH0pO1xuICB9XG59Il0sIm5hbWVzIjpbInN1cGFiYXNlIiwiY2hlY2tVc2VyQ3JlZGl0cyIsImRlZHVjdENyZWRpdHMiLCJhZGRDcmVkaXRzIiwiaGFuZGxlciIsInJlcSIsInJlcyIsImRhdGEiLCJzZXNzaW9uIiwiZXJyb3IiLCJhdXRoRXJyb3IiLCJhdXRoIiwiZ2V0U2Vzc2lvbiIsInN0YXR1cyIsImpzb24iLCJ1c2VySWQiLCJ1c2VyIiwiaWQiLCJtZXRob2QiLCJjcmVkaXRDaGVjayIsInN1Y2Nlc3MiLCJjcmVkaXRzIiwiY3VycmVudENyZWRpdHMiLCJoYXNFbm91Z2hDcmVkaXRzIiwicmVzZXREYXRlIiwiYWN0aW9uIiwiYW1vdW50IiwiYm9keSIsInJlc3VsdCIsImNvbnNvbGUiLCJtZXNzYWdlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./pages/api/test-credits.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Ftest-credits&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Ftest-credits.js&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();