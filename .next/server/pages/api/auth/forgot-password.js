"use strict";(()=>{var e={};e.id=6048,e.ids=[6048],e.modules={2885:e=>{e.exports=require("@supabase/supabase-js")},8769:e=>{e.exports=require("daisyui/src/theming/themes.js")},8941:e=>{e.exports=require("form-data")},8557:e=>{e.exports=require("mailgun.js")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},1689:(e,r,t)=>{t.r(r),t.d(r,{config:()=>c,default:()=>p,routeModule:()=>w});var s={};t.r(s),t.d(s,{default:()=>handler});var o=t(1802),a=t(7153),i=t(6249),n=t(4768);let d=require("crypto");var u=t.n(d),l=t(2110);async function handler(e,r){if("POST"!==e.method)return r.status(405).json({error:"Method not allowed"});try{let{email:t}=e.body;if(!t)return r.status(400).json({error:"Email is required"});let{data:s,error:o}=await n.O.auth.admin.getUserByEmail(t);if(o)return r.status(200).json({message:"If an account with that email exists, password reset instructions have been sent"});let a=u().randomBytes(32).toString("hex"),i=new Date(Date.now()+36e5),{error:d}=await n.O.from("password_reset_tokens").insert([{user_id:s.id,email:t,token:a,expires_at:i.toISOString()}]);if(d)return console.error("Token storage error:",d),r.status(500).json({error:"Server error"});let p=`${process.env.NEXTAUTH_URL}/auth/reset-password?token=${a}`;return await (0,l.C)(t,"Reset your HOPWELL password",`You requested a password reset. Please go to this link to reset your password: ${p}`,`
        <div style="max-width: 600px; margin: 0 auto; padding: 20px;">
          <h2 style="color: #312e81; margin-bottom: 20px;">Reset Your HOPWELL Password</h2>
          <p>You requested a password reset. Please click the button below to reset your password:</p>
          <div style="text-align: center; margin: 30px 0;">
            <a href="${p}" style="background-color: #312e81; color: white; padding: 12px 24px; text-decoration: none; border-radius: 4px; display: inline-block;">Reset Password</a>
          </div>
          <p>If you didn't request a password reset, you can safely ignore this email.</p>
          <p>The link will expire in 1 hour.</p>
        </div>
      `),r.status(200).json({message:"Password reset instructions sent"})}catch(e){return console.error("Password reset error:",e),r.status(500).json({error:"Server error"})}}let p=(0,i.l)(s,"default"),c=(0,i.l)(s,"config"),w=new o.PagesAPIRouteModule({definition:{kind:a.x.PAGES_API,page:"/api/auth/forgot-password",pathname:"/api/auth/forgot-password",bundlePath:"",filename:""},userland:s})}};var r=require("../../../webpack-api-runtime.js");r.C(e);var __webpack_exec__=e=>r(r.s=e),t=r.X(0,[4222,4768,2110],()=>__webpack_exec__(1689));module.exports=t})();